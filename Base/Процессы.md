# Процессы
Это абстракция описывающая выполнение программы. Они дают возможность выполнять псевдопараллельные вычисления за счет поочередной работы, их работа длится доли секунд, поэтому для человека это не заметно, они превращают один физический процессор в несколько виртуальных (1 процесс выполняется на 1 ядре одного [[Processor|процессора]], 2 процесса могут выполняться либо на двух одноядерных процессорах, либо на 1 двухъядерном процессоре). Каждый процесс имеет как минимум я [[Потоки|поток]]

# Польза процессов
Допустим мы запустили игру, и пока она запускается хотим посидеть в интернете, соответственно. Запускаем игру - 1 процесс, запускаем браузер - 2 процесс. За счет того, что есть такая абстракция как процесс, мы можем сидеть в браузере и ждать, пока наша игра запустится, т.к. ЦП поочередно предоставляет ресурсы им.

Один процессор имеет один физический счетчик команд - это то что он будет делать. У каждого процесса есть логический счетчик команд, когда очередной процесс начинает свою работу, они копирует свой логический счетчик в физический счет процессора, когда он заканчивается работу, он обратно копирует его к себе, что понимать на чем он остановился.

![[../Files/Pasted image 20220315134614.png]]

# Модель процесса
В этой модели все выполняемое ПО на компьютере сведено к ряду процессов.

**Процесс** - это экземпляр выполняемой программы.
Программа, код - это алгоритм, а процесс - это его выполнение.

Мы можем 5 раз запустить одну программу и у нас будет 5 процессов, который будут использовать одни и те же инструкции, т.е. в память не будет 5 раз загружаться код.

# Создание процесса
Существует 4 события приводящие к созданию процесса:
1. **Инициализация системы** - при запуске OS создается ряд процессов(ввод и проверка пароля, проверка электронной почты). Фоновые процессы предназначенные для мониторинга событий называют демонами.
2. **Выполнение работающим процессом системного вызова предназначенного для создания процесса.** Такая схема нужна для более быстрого выполнения программы. Допустим, один процесс помещает в буфер файлы, другой их печатает.
3. **Запрос пользователя на создание нового процесса.** Запуск программы с помощью мышки или команды терминала.
4. **Инициализация пакетного задания.** Данное событие применимо только к системам пакетной обработки данных. Есть система, пользователи могут удаленно посылать ей пакетные задания, если у OS есть ресурсы на ее выполнение, то она запускает процесс.

# Завершение процесса
Существуют 4 события приводящие к завершению процесса:
1. **Обычный выход(добровольно).** Выход из оконного приложения с помощью крестика.
2. **Выход при возникновении ошибки(добровольно).** Например, если мы попытаемся скомпилировать файл которого не существует, то выбросится ошибка и компилятор завершит работу.
3. **Возникновение фатальной ошибки(принудительно).** Ошибка вызванная самим процессом(обращение по индексу за пределы массива, обращение к несуществующему адресу, деление на 0).
4. **Уничтожение другим процессом(принудительно).** У процесса, вызывающего завершения должны быть на это соответствующие полномочия.

# Иерархия процессов
Родительский процесс может породить дочерний, а дочерний тоже может породить, причем каждый из них может породить несколько процессов. Так возникает иерархия процессов.

# Состояния процессов
Существуют 3 состояния в котором может находиться процесс:
1. **Выполняемый** - т.е. использующий в данный момент времени ресурсы ЦП.
2. **Готовый** - работоспособный, но временно приостановленный, чтобы дать возможность другим процессам использовать ресурсы ЦП.
3. **Блокированный** - неспособный выполняться пока не возникнет какое-то внешнее событие

Между этими 3 состояниями существуют 4 перехода

![[../Files/Pasted image 20220315143540.png]]

1. **Переход 1:** происходит если ОС определит, что процесс в данный момент времени выполняться не может.
2. **Переход 2 и 3:** вызываются планировщиком процессов, который является частью ОС без какого-либо оповещения самого процесса.
3. **Переход 2:** происходит, когда планировщик решит, что выполняемый процесс продвинулся достаточно далеко и настало время другому процессу.
4. **Переход 3:** происходит, когда все другие процессы получили причитающуюся долю процессорного времени и настал момент предоставить ресурсы ЦП первому процессу для возобновления его выполнения.
5. **Переход 4:** осуществляется в том случае, если происходит внешнее событие, ожидавшееся процессом(поступление входных данных). Если к этому моменту нет других выполняемых процессов, будет вызван переход 3 и процесс возобновится. В противном случае ему придется немного подождать в состоянии готовности, пока не станут доступы ресурсы ЦП и не придет его очередь.

# Реализация процессов
Для реализации модели процессов ОС ведет таблицу процессов, в которой каждая запись соответствует какому-либо процессу. Эти записи содержат важную информацию о состоянии процессов(все, что должно быть сохранено при переключении процесса).