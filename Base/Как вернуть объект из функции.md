# Как вернуть объект из функции?
Очевидно, с помощью `return`, но почему?

1. Прямо по сигнатуре функции видно, что она возвращает
2. Внутри функции видно выражение return что-то, функцию завершили, данные вернули
3. Специально для return придуманы оптимизации [[Copy elision]], и, собственно, `move`-семантика

Но есть случаи когда return оптимизация не работает(если у объекта много данных на стеке).

```cpp
UserInfo ReadUserInfo(istream& in_stream) { 
	return ReadUser().info; 
}
```

Если будет возвращаться не локальная переменная, а какой-то другой, пусть даже временный объект, точнее, поле временного объекта, то в этом случае не сработает ни copy ellision, ни NRVO, а move-семантика нам не поможет, потому что у этой структуры со временем будет всё больше и больше данных на стеке.

Даже если не использовать return, объекты у которых много данных на стеке много сильно тормозить программу

```cpp
int main() { 
	vector<UserInfo> users; 
	sort(begin(users), end(users)); 
}
```

Со временем структура может обрастать все большим количеством данных на стеке, сортировка внутри будет переставлять элементы местами,  поэтому это будет долго.

Как быть? Если у нас много данных на стеке, то стоит использовать `unique_ptr`.

```cpp
using InfoPtr = unique_ptr; 
InfoPtr ReadUserInfo(istream& in_stream) { 
	const auto info_ptr = make_unique(); 
	UserInfo& info = *info_ptr; 
	in_stream >> info.name; 
	in_stream >> info.age; 
	//... 
	return info_ptr; 
} 
int main() { 
	vector<InfoPtr> users; 
	sort(begin(users), end(users)); 
}
```

Преимущество этого подхода в том, что мы отселяем объект, у которого много данных на стеке, в кучу. Объекты хранятся в одном конкретном месте и никуда оттуда не перемещаются, только если мы явно не захотим как-то их скопировать.

И теперь у нас и сортировка будет в порядке, потому что будем переставлять указатели на кучу.