# Протокол ICMP
Internet Control Message Protocol - протокол межсетевых управляющих сообщений. Он нужен для:
1. Сообщения об ошибках в работе сети - т.к. [[Протокол IP]] не отправляет какие-либо сообщения, если пакет не дошел. Сообщения ICMP не обязательно должны обрабатываться
	1. Получатель недоступен 
	2. Закончилось время жизни пакета (TTL) - счетчик hop - уменьшается каждый раз при заходе в новую сеть
	3. Запрещено фрагментировать пакет
2. Тестирование работы сети
	1. ping (проверка доступности получателя)
	2. traceroute (определение маршрута к получателю)

# Формат заголовка
![[icmp.excalidraw]]

# Типы ICMP- сообщений
| Тип | Назначение сообщения              |
| --- | --------------------------------- |
| 0   | Эхо-ответ                         |
| 3   | Узел назначения недостижим        |
| 5   | Перенаправления маршрута          |
| 8   | Эхо-запрос                        |
| 9   | Сообщение о маршрутизаторе        |
| 10  | Запрос сообщения о маршрутизаторе |
| 11  | Истечение времени жизни пакета    |
| 12  | Проблемы с параметрами            |
| 13  | Запрос отметки времени            |
| 14  | Ответ отметки времени             |

# Коды ICMP- сообщений (для типа 3)
| Код | Причина                     |
| --- | --------------------------- |
| 0   | Сеть недостижима            |
| 1   | Узел недостижим             |
| 2   | Протокол недостижим         |
| 3   | Порт недостижим             |
| 4   | Ошибка фрагментации         |
| 5   | Ошибка в маршруте источника |
| 6   | Сеть назначения неизвестна  |
| 7   | Узел назначения неизвестен  |
| 8   | Узел-источник изолирован    |
| 9   | Административный запрет     |

