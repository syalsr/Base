# Конструктор копирования и оператор присваивания
Конструктор копирования и оператор присваивания, генерируемый компилятором, полностью копирует все переменные из одного объекта в другой, если мы будем динамически выделим память, то в объекте у нас есть указатель на кучу, при копировании этот указатель скопируется, в итоге 2 указателя указывают на одно и тоже место, мы можем можем удалить его 2 раза, потеряет указатель на выделенную память $=>$ произойдет утечка памяти, в общем программа скорее всего аварийно завершится, поэтому мы должны сами определять конструктор копирования и оператор присваивания, чтобы этого избежать.

Конструктор копирования и оператор присваивания позволяют создавать объект на основе другого объекта.

В следующих случаях вызывается конструктор копирования (copy constructor):

![[../Files/Pasted image 20220218114900.png]]

```cpp
template<typename T>
SimpleVector<T>::SimpleVector(const SimpleVector<T>& other) 
	: data(new T[other.capacity ]), 
	  size(other.size), 
	  capacity(other. capacity) 
{ 
	copy(other.begin(), other.end(), begin()); 
}
```

В следующих случаях вызывается оператор копирующего присваивания (copy assignment operator):

![[../Files/Pasted image 20220218114921.png]]

Для собственных типов при необходимости компилятор сам генерирует конструктор копирования и оператор присваивания, которые просто копируют все поля. 

Для типов, которые самостоятельно управляют памятью, нужно самостоятельно реализовывать копирование и присваивание.

```cpp
template<typename T>
SimpleVector<T>& SimpleVector<T>::operator=(const SimpleVector<T>& rhs) 
	: size(other.size), 
	  capacity(other. capacity) 
{
	if(this != &rhs && *this != rhs)
	{
		delete data;
		data = new T[other.capacity ];
		copy(rhs.begin(), rhs.end(), begin());
	}
	return *this;
}
```